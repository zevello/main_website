(()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,a(i.key),i)}}function r(t,e,r){return(e=a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(e){var r=function(e,r){if("object"!==t(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,r||"default");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===t(r)?r:String(r)}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"$filterForm",$(document).find("form.filter-form")),r(this,"$table",this.$filterForm.closest(".table-wrapper").find("table"))}var a,i,n;return a=t,(i=[{key:"loadData",value:function(t){$httpClient.make().get($(".filter-data-url").val(),{class:$(".filter-data-class").val(),key:t.val(),value:t.closest(".filter-item").find(".filter-column-value").val()}).then((function(e){var r=e.data,a=$.map(r.data,(function(t,e){return{id:e,name:t}}));t.closest(".filter-item").find(".filter-column-value-wrap").html(r.html);var i=t.closest(".filter-item").find(".filter-column-value");i.length&&"text"===i.prop("type")&&(i.typeahead({source:a}),i.data("typeahead").source=a),Botble.initResources()}))}},{key:"init",value:function(){var t=this,e=this;$.each($(".filter-items-wrap .filter-column-key"),(function(t,r){$(r).val()&&e.loadData($(r))})),this.$filterForm.on("change",".filter-column-key",(function(t){e.loadData($(t.currentTarget))})).on("click",".add-more-filter",(function(){var t=$(document).find(".sample-filter-item-wrap").html();$(document).find(".filter-items-wrap").append(t.replace("<script>","").replace("<\\/script>","")),Botble.initResources();var r=$(document).find(".filter-items-wrap .filter-item:last-child").find(".filter-column-key");$(r).val()&&e.loadData(r)})).on("click",".btn-remove-filter-item",(function(t){t.preventDefault();var e=$(t.currentTarget);e.closest(".filter-item").remove(),e.tooltip("hide")})).on("click",".btn-apply",(function(e){e.preventDefault();var r=$(e.currentTarget).closest("form.filter-form");t.$filterForm.find('[data-bb-toggle="datatable-reset-filter"]').show();var a=new URL(window.location.href),i=new URLSearchParams(a.search),n=r.serializeArray();$.each(n,(function(t,e){i.set(e.name,e.value)})),window.history.pushState({},"","".concat(a.pathname,"?").concat(i.toString())),t.reloadDatatable(t.$table.DataTable())})).on("click",'[data-bb-toggle="datatable-reset-filter"]',(function(e){e.preventDefault(),t.$filterForm.find(".form-filter:not(.filter-item-default)").remove(),t.$filterForm.find(".filter-item").find(".filter-column-key").val("").trigger("change"),t.$filterForm.find(".filter-item").find(".filter-column-operator").val("="),t.$filterForm.find(".filter-item").find(".filter-column-value").val(""),$(e.currentTarget).hide();var r=new URL(window.location.href);window.history.pushState({},"",r.pathname),t.reloadDatatable(t.$table.DataTable())}))}},{key:"reloadDatatable",value:function(t){t.ajax.url(window.location.href).load()}}])&&e(a.prototype,i),n&&e(a,n),Object.defineProperty(a,"prototype",{writable:!1}),t}();$((function(){(new i).init()}))})();
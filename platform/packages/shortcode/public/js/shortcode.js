(()=>{"use strict";$((function(){$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,(function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""})),e};var e=$("#shortcode-list-modal"),t=$("#shortcode-modal");function o(e){d({href:e.attr("href"),key:e.data("key"),description:e.data("description")})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.href,d=e.key,a=e.description,i=void 0===a?null:a,r=e.data,c=void 0===r?{}:r,n=e.update,s=void 0!==n&&n,l=e.previewImage,h=void 0===l?null:l;$(".shortcode-admin-config").html("");var m=$('.shortcode-modal button[data-bb-toggle="shortcode-add-single"]');m.text(m.data(s?"update-text":"add-text")),null!=i&&$(".shortcode-modal .modal-title").text(i),null!=h&&""!==h?$(".shortcode-modal .shortcode-preview-image-link").attr("href",h).show():$(".shortcode-modal .shortcode-preview-image-link").hide(),$(".shortcode-modal").modal("show");var u=t.find(".modal-content");Botble.showLoading(u),$httpClient.make().post(o,c).then((function(e){var t=e.data;$(".shortcode-data-form").trigger("reset"),$(".shortcode-input-key").val(d),$(".shortcode-admin-config").html(t.data),Botble.hideLoading(u),Botble.initResources(),Botble.initMediaIntegrate(),document.dispatchEvent(new CustomEvent("core-shortcode-config-loaded"))}))}$('[data-bb-toggle="shortcode-item-radio"]').on("change",(function(){$('[data-bb-toggle="shortcode-use"]').prop("disabled",!1).removeClass("disabled")})),$('[data-bb-toggle="shortcode-add-single"]').on("click",(function(e){e.preventDefault();var t=$(".shortcode-modal").find(".shortcode-data-form"),o=t.serializeObject(),d="";$.each(o,(function(e,o){var a=t.find('*[name="'+e+'"]'),i=a.data("shortcode-attribute");i&&"content"===i||!o||(e=e.replace("[]",""),o&&"string"==typeof o&&(o=(o=o.replace(/"([^"]*)"/g,"“$1”")).replace(/"/g,"“")),"content"!==a.data("shortcode-attribute")&&(e=e.replace("[]",""),d+=" "+e+'="'+o+'"'))}));var a="",i=t.find("*[data-shortcode-attribute=content]");null!=i&&null!=i.val()&&""!==i.val()&&(a=i.val());var r=$(this).closest(".shortcode-modal").find(".shortcode-input-key").val(),c=$(".add_shortcode_btn_trigger").data("result"),n="["+r+d+"]"+a+"[/"+r+"]";if(window.EDITOR&&window.EDITOR.CKEDITOR&&$(".editor-ckeditor").length>0)window.EDITOR.CKEDITOR[c].commands.execute("shortcode",n);else if($(".editor-tinymce").length>0)tinymce.get(c).execCommand("mceInsertContent",!1,n);else{var s=new CustomEvent("core-insert-shortcode",{detail:{shortcode:n}});document.dispatchEvent(s)}$(this).closest(".modal").modal("hide")})),$(document).on("click",'[data-bb-toggle="shortcode-list-modal"]',(function(){e.modal("show")})),$('[data-bb-toggle="shortcode-select"]').on("dblclick",(function(e){o($(e.currentTarget))})),$('[data-bb-toggle="shortcode-use"]').on("click",(function(){o(e.find(".shortcode-item-input:checked").closest(".shortcode-item-wrapper")),$('[data-bb-toggle="shortcode-item-radio"]').prop("checked",!1),$('[data-bb-toggle="shortcode-use"]').prop("disabled",!0).addClass("disabled")})),$('[data-bb-toggle="shortcode-button-use"]').on("click",(function(e){o($(e.currentTarget).closest(".shortcode-item-wrapper"))})),t.on("show.bs.modal",(function(){e.modal("hide"),$('[data-bb-toggle="shortcode-item-radio"]').prop("checked",!1),$('[data-bb-toggle="shortcode-use"]').prop("disabled",!0).addClass("disabled")})),$(document).on("ckeditor-bb-shortcode-callback",(function(e){var t=e.detail;d({key:t.shortcode,href:t.options.url,previewImage:""})})),$(document).on("ckeditor-bb-shortcode-edit",(function(e){var t=e.detail,o=t.shortcode,a=t.name,i=$('[data-bb-toggle="shortcode-select"][data-key="'.concat(a,'"]')),r=i.length>0?i.data("description"):"";d({key:a,href:route("short-codes.ajax-get-admin-config",a),data:{key:a,code:o},description:r,previewImage:"",update:!0})}))}))})();